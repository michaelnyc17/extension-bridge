let PortabilityAnalyzer={CHROME_ONLY_APIS:["chrome.instanceID","chrome.gcm","chrome.enterprise","chrome.documentScan","chrome.accessibilityFeatures","chrome.wallpaper","chrome.imageWriterPrivate","chrome.mediaGalleries"],MV3_SERVICE_WORKER_APIS:["chrome.offscreen","chrome.sidePanel","chrome.userScripts"],analyzePortability(e){var i=e.manifestVersion||2,s=e.permissions||[],e=e.hostPermissions||[],r=this.checkChromeOnlyAPIs(s),l=this.checkMV3ServiceWorkerAPIs(s),a={level:"likely",label:"✅ Likely Portable",className:"portability-likely",reasons:[],confidence:"high"},r=(0<r.length?(a.level="unlikely",a.label="❌ Unlikely Portable",a.className="portability-unlikely",a.confidence="high",a.reasons.push("Uses Chrome-only APIs: "+r.join(", "))):3===i&&0<l.length?(a.level="maybe",a.label="⚠️ Maybe Portable",a.className="portability-maybe",a.confidence="medium",a.reasons.push("Uses MV3 service worker APIs (Firefox support may be limited)")):3===i?(a.level="maybe",a.label="⚠️ Maybe Portable",a.className="portability-maybe",a.confidence="medium",a.reasons.push("Uses Manifest V3 (Firefox support is improving)")):2===i&&(a.level="likely",a.label="✅ Likely Portable",a.className="portability-likely",a.confidence="high",a.reasons.push("Uses Manifest V2 (well-supported in Firefox)")),this.checkExcessivePermissions(s,e));return 0<r.length&&("likely"===a.level&&(a.level="maybe",a.label="⚠️ Maybe Portable",a.className="portability-maybe",a.confidence="medium"),a.reasons.push("Uses sensitive permissions: "+r.join(", "))),a.manifestVersion=i,a},checkChromeOnlyAPIs(e){return e.filter(i=>this.CHROME_ONLY_APIS.some(e=>i.includes(e.replace("chrome.",""))))},checkMV3ServiceWorkerAPIs(e){return e.filter(i=>this.MV3_SERVICE_WORKER_APIS.some(e=>i.includes(e.replace("chrome.",""))))},checkExcessivePermissions(e,i){let s=["debugger","desktopCapture","downloads","management","nativeMessaging","privacy","proxy","system"];e=e.filter(i=>s.some(e=>i.includes(e)));return i&&i.some(e=>"<all_urls>"===e||"*://*/*"===e)&&e.push("broad host access"),e},getPortabilityExplanation(e){return{likely:"This extension uses standard web extension APIs that are well-supported in Firefox. Porting should be straightforward with minimal changes.",maybe:"This extension may require modifications to work in Firefox. Some APIs or features might need adjustments or alternative implementations.",unlikely:"This extension uses Chrome-specific features that have no Firefox equivalent. Significant rewriting would be needed to port this extension."}[e.level]||""}};